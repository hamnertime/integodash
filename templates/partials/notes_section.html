<h2>Client Notes</h2>
<form method="POST" action="{{ url_for('client_billing_details', account_number=client.account_number) }}">
     <textarea name="note_content" rows="3" placeholder="Add a new billing note..." style="width: 100%; padding: 8px; border: 1px solid var(--input-border); border-radius: 4px; box-sizing: border-box; background-color: var(--input-bg); color: var(--text-color);"></textarea>
     <div style="text-align: right; margin-top: 10px;">
         <button type="submit" name="action" value="add_note">Add Note</button>
     </div>
</form>
<div class="search-attachments" style="margin-top: 15px;">
    <input type="text" id="notes-search" placeholder="Search notes..." value="{{ search_query }}">
</div>
<hr style="margin: 20px 0;">
{% for note in notes %}
    <div class="note">
        <div>{{ note.note_content | markdown | safe }}</div>
        <p class="note-meta">
            <span>
                Added on {{ note.created_at | humanize }}
                <span class="note-actions">
                   <button type="button" class="icon-button edit edit-note" data-note-id="{{ note.id }}" data-note-content="{{ note.note_content }}">
                        <svg viewBox="0 0 24 24"><path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.13,5.12L18.88,8.87M3,17.25V21H6.75L17.81,9.94L14.06,6.19L3,17.25Z" /></svg>
                   </button>
                   <a href="{{ url_for('client_billing_details', account_number=client.account_number, delete_note=note.id) }}" class="icon-button delete" onclick="return confirm('Are you sure you want to delete this note?');">
                        <svg viewBox="0 0 24 24"><path d="M9,3V4H4V6H5V19C5,20.1 5.9,21 7,21H17C18.1,21 19,20.1 19,19V6H20V4H15V3H9M7,6H17V19H7V6M9,8V17H11V8H9M13,8V17H15V8H13Z" /></svg>
                   </a>
                </span>
            </span>
        </p>
    </div>
{% else %}
    <p>No billing notes for this client yet.</p>
{% endfor %}
<div class="pagination" style="margin-top: 20px; text-align: center; display: flex; justify-content: space-between; align-items: center;">
    <div>
        {% if total_pages > 1 %}
            {% if page > 1 %}
                <a href="{{ url_for('client_billing_details', account_number=client.account_number, year=selected_year, month=selected_month, page=page-1, per_page=per_page) }}" class="button">&laquo; Previous</a>
            {% endif %}

            <span style="margin: 0 15px;">Page {{ page }} of {{ total_pages }}</span>

            {% if page < total_pages %}
                <a href="{{ url_for('client_billing_details', account_number=client.account_number, year=selected_year, month=selected_month, page=page+1, per_page=per_page) }}" class="button">Next &raquo;</a>
            {% endif %}
        {% endif %}
    </div>
    <form method="get" action="{{ url_for('client_billing_details', account_number=client.account_number) }}">
        <input type="hidden" name="year" value="{{ selected_year }}">
        <input type="hidden" name="month" value="{{ selected_month }}">
        <label for="per_page">Notes per page:</label>
        <select name="per_page" id="per_page">
            <option value="10" {% if per_page == 10 %}selected{% endif %}>10</option>
            <option value="20" {% if per_page == 20 %}selected{% endif %}>20</option>
            <option value="50" {% if per_page == 50 %}selected{% endif %}>50</option>
            <option value="100" {% if per_page == 100 %}selected{% endif %}>100</option>
        </select>
    </form>
</div>
