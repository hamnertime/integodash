{% extends "layout.html" %}
{% block title %}{{ article.title }}{% endblock %}

{% block content %}
<div class="page-header">
    <h1>{{ article.title }}</h1>
    <div>
        {% if session['role'] in ['Admin', 'Editor', 'Contributor'] %}
        <a href="{{ url_for('kb.edit_article', article_id=article.id) }}" class="button">Edit Article</a>
        {% endif %}
        {% if session['role'] in ['Admin', 'Editor'] %}
        <form action="{{ url_for('kb.delete_article', article_id=article.id) }}" method="post" style="display:inline;" onsubmit="return confirm('Are you sure you want to delete this article?');">
            <button type="submit" class="button danger">Delete</button>
        </form>
        {% endif %}
    </div>
</div>

<div class="info-card">
    <p>
        <strong>Author:</strong> {{ article.author_name }} |
        <strong>Last Updated:</strong> {{ article.updated_at | humanize }} |
        <strong>Client:</strong>
        {% if article.visibility == 'Client' %}
            <a href="{{ url_for('clients.client_billing_details', account_number=article.company_account_number) }}">{{ article.company_name }}</a>
        {% else %}
            {{ article.visibility }}
        {% endif %}
    </p>
    {% if categories %}
    <p>
        <strong>Categories:</strong>
        {% for category in categories %}
            <span class="tag">{{ category.name }}</span>{% if not loop.last %}, {% endif %}
        {% endfor %}
    </p>
    {% endif %}
    <hr>
    <div>
        {{ article.content | markdown | safe }}
    </div>
</div>
{% endblock %}
